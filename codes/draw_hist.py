import matplotlib.pyplot as plt
import matplotlib
import numpy as np


fine_label_names = ['apple', 'aquarium_fish', 'baby', 'bear', 'beaver', 'bed', 'bee', 'beetle', 'bicycle', 'bottle',
                    'bowl', 'boy', 'bridge', 'bus', 'butterfly', 'camel', 'can', 'castle', 'caterpillar', 'cattle',
                    'chair', 'chimpanzee', 'clock', 'cloud', 'cockroach', 'couch', 'crab', 'crocodile', 'cup',
                    'dinosaur', 'dolphin', 'elephant', 'flatfish', 'forest', 'fox', 'girl', 'hamster', 'house',
                    'kangaroo', 'keyboard', 'lamp', 'lawn_mower', 'leopard', 'lion', 'lizard', 'lobster', 'man',
                    'maple_tree', 'motorcycle', 'mountain', 'mouse', 'mushroom', 'oak_tree', 'orange', 'orchid',
                    'otter', 'palm_tree', 'pear', 'pickup_truck', 'pine_tree', 'plain', 'plate', 'poppy', 'porcupine',
                    'possum', 'rabbit', 'raccoon', 'ray', 'road', 'rocket', 'rose', 'sea', 'seal', 'shark', 'shrew',
                    'skunk', 'skyscraper', 'snail', 'snake', 'spider', 'squirrel', 'streetcar', 'sunflower',
                    'sweet_pepper', 'table', 'tank', 'telephone', 'television', 'tiger', 'tractor', 'train', 'trout',
                    'tulip', 'turtle', 'wardrobe', 'whale', 'willow_tree', 'wolf', 'woman', 'worm']


def draw_hist(data_lists, label_list=None, data_label=None, info=None, filename=None):
    x = range(len(label_list))
    x = [i*4 for i in x]
    plt.figure(num=1, figsize=(len(label_list)*2, 10))
    max_data = 0
    for idx in range(len(data_lists)):
        rects = plt.bar(x=[i+0.6*idx for i in x], height=data_lists[idx], width=0.6, alpha=0.8, label=data_label[idx])
        max_data = max(max_data, max(data_lists[idx]))
        for rect in rects:
            height = rect.get_height()
            plt.text(rect.get_x() + rect.get_width() / 2, height + 0.01, f"{height:.2f}", ha="center", va="bottom")
    plt.ylim(0, max_data)
    plt.ylabel('rate')
    plt.xticks([index + 0.4 for index in x], label_list)
    plt.title(info)
    plt.legend()
    if filename is not None:
        plt.savefig(filename)
    plt.show()


def draw_hist_old(num_list1, num_list2, label_list=None, info=None, filename=None):
    if label_list is None:
        label_list = [i for i in range(0, len(num_list1))]    # 横坐标刻度显示值
    x = range(len(num_list1))
    """
    绘制条形图
    left:长条形中点横坐标
    height:长条形高度
    width:长条形宽度，默认值0.8
    label:为后面设置legend准备
    """
    plt.figure(num=1, figsize=(len(label_list), 10))
    rects1 = plt.bar(x=x, height=num_list1, width=0.4, alpha=0.8, color='red', label="net1")
    rects2 = plt.bar(x=[i + 0.4 for i in x], height=num_list2, width=0.4, color='green', label="net2")
    plt.ylim(0, 1)     # y轴取值范围
    plt.ylabel("rate")
    """
    设置x轴刻度显示值
    参数一：中点坐标
    参数二：显示值
    """
    plt.xticks([index + 0.2 for index in x], label_list)
    if info is not None:
        plt.title(info)
    else:
        plt.title("correct rate")
    plt.legend()     # 设置题注
    # 编辑文本
    for rect in rects1:
        height = rect.get_height()
        plt.text(rect.get_x() + rect.get_width() / 2, height+0.01, str(height), ha="center", va="bottom")
    for rect in rects2:
        height = rect.get_height()
        plt.text(rect.get_x() + rect.get_width() / 2, height+0.01, str(height), ha="center", va="bottom")
    if filename is not None:
        plt.savefig(filename)
    plt.show()


def draw_activated(data_list, x_axix):
    data_list = [item.flatten() for item in data_list]
    for idx, data in enumerate(data_list):
        plt.plot(x_axix[idx], data)
    plt.show()


if __name__ == '__main__':
    nan = 0
    f1_scores_ref = [0.9295634920634921, 0.9575328614762386, 0.9177183240787481, 0.8505859375, 0.9422980431510286,
                     0.8959276018099547, 0.9495252373813093, 0.9604406609914872, 0.949, 0.9414121181772658]
    f1_scores_023 = [0.37931034482758624, 0.3917525773195877, 0.27906976744186046, 0.16279069767441862,
                     0.15517241379310345, 0.13043478260869565, 0.2711864406779661, 0.21621621621621623,
                     0.3829787234042554, 0.20000000000000004, 0.2117647058823529, 0.3333333333333333,
                     0.30769230769230765, 0.1702127659574468, 0.19354838709677422, 0.3578947368421052,
                     0.10101010101010102, 0.2528735632183908, 0.12903225806451613, 0.23076923076923075,
                     0.3655913978494624, 0.40909090909090906, 0.3636363636363636, 0.42718446601941745,
                     0.205607476635514, 0.3578947368421052, 0.2156862745098039, 0.09638554216867469, 0.2553191489361702,
                     0.13953488372093023, 0.1590909090909091, 0.2716049382716049, 0.1415929203539823,
                     0.16494845360824742, 0.2988505747126437, 0.29906542056074764, 0.32, 0.2716049382716049,
                     0.3181818181818182, 0.24074074074074073, 0.13186813186813184, 0.2156862745098039,
                     0.1894736842105263, 0.2826086956521739, 0.3736263736263737, 0.3132530120481928, 0.2580645161290322,
                     0.2417582417582418, 0.16949152542372883, 0.12844036697247707, 0.3333333333333333,
                     0.2264150943396226, 0.30927835051546393, 0.2823529411764706, 0.29702970297029707,
                     0.2285714285714286, 0.3132530120481928, 0.3116883116883117, 0.43373493975903615,
                     0.2826086956521739, 0.268041237113402, 0.23655913978494625, 0.14583333333333334,
                     0.17977528089887643, 0.128, 0.2150537634408602, 0.34693877551020413, 0.198019801980198,
                     0.3434343434343435, 0.20689655172413793, 0.2524271844660194, 0.4193548387096775,
                     0.2247191011235955, 0.22448979591836735, 0.40860215053763443, 0.21782178217821785,
                     0.24761904761904763, 0.2, 0.35398230088495575, 0.23404255319148937, 0.20869565217391306, 0.5,
                     0.2758620689655172, 0.24742268041237112, 0.2616822429906542, 0.1443298969072165, 0.25,
                     0.2524271844660194, 0.12173913043478263, 0.23008849557522124, 0.31250000000000006,
                     0.34782608695652173, 0.2105263157894737, 0.1951219512195122, 0.4123711340206186,
                     0.22018348623853212, 0.18604651162790697, 0.22727272727272727, 0.26, 0.1487603305785124,
                     0.1851851851851852, 0.2826086956521739, 0.2692307692307692, 0.4742268041237113, 0.1132075471698113,
                     0.16417910447761194, 0.17741935483870966, 0.42105263157894735, 0.34, 0.3541666666666667,
                     0.2342342342342342, 0.31481481481481477, 0.21276595744680854, 0.2786885245901639,
                     0.21238938053097342, 0.40366972477064217, 0.16842105263157894, 0.38834951456310685, 0.26,
                     0.1702127659574468, 0.30927835051546393, 0.28205128205128205, 0.12280701754385966,
                     0.25225225225225223, 0.4137931034482759, 0.10989010989010989, 0.27419354838709675,
                     0.24742268041237112, 0.22, 0.22222222222222224, 0.20869565217391306, 0.12, 0.1111111111111111,
                     0.4318181818181818, 0.20202020202020204, 0.11111111111111112, 0.2666666666666666,
                     0.19354838709677422, 0.19354838709677422, 0.1956521739130435, 0.31250000000000006,
                     0.2608695652173913, 0.26966292134831465, 0.5000000000000001, 0.26666666666666666,
                     0.3703703703703704, 0.2828282828282828, 0.2727272727272727, 0.3168316831683168,
                     0.27956989247311825, 0.27956989247311825, 0.2528735632183908, 0.19199999999999998,
                     0.3300970873786408, 0.2597402597402597, 0.3061224489795918, 0.2545454545454545,
                     0.23655913978494625, 0.2857142857142857, 0.04687500000000001, 0.205607476635514,
                     0.27450980392156865, 0.2758620689655172, 0.30434782608695654, 0.27368421052631575,
                     0.45783132530120485, 0.5, 0.24999999999999994, 0.16129032258064516, 0.2631578947368421,
                     0.34090909090909094, 0.3505154639175258, 0.09433962264150945, 0.4081632653061225,
                     0.24999999999999994, 0.06, 0.3440860215053763, 0.14678899082568808, 0.23157894736842105,
                     0.2268041237113402, 0.17777777777777778, 0.31775700934579443, 0.1647058823529412,
                     0.24299065420560748, 0.3877551020408163, 0.2833333333333333, 0.2545454545454545, 0.3,
                     0.11464968152866241, 0.3703703703703704, 0.17391304347826086, 0.24999999999999994,
                     0.23214285714285712, 0.43749999999999994, 0.3508771929824561, 0.13793103448275862,
                     0.2616822429906542, 0.08695652173913043, 0.25806451612903225, 0.2653061224489796]
    f1_scores_024 = [0.3673469387755102, 0.34285714285714286, 0.30952380952380953, 0.1702127659574468,
                     0.1346153846153846, 0.14545454545454545, 0.27184466019417475, 0.18390804597701146,
                     0.32558139534883723, 0.17142857142857143, 0.22222222222222224, 0.3, 0.3305785123966943,
                     0.33333333333333326, 0.3157894736842105, 0.18749999999999997, 0.16091954022988506,
                     0.27368421052631575, 0.16822429906542055, 0.28571428571428564, 0.4318181818181818,
                     0.3829787234042554, 0.3956043956043956, 0.42424242424242425, 0.15094339622641512,
                     0.3333333333333333, 0.2268041237113402, 0.19512195121951217, 0.3030303030303031,
                     0.1978021978021978, 0.2117647058823529, 0.29906542056074764, 0.18, 0.19999999999999998,
                     0.2823529411764706, 0.3047619047619048, 0.3023255813953488, 0.24390243902439027,
                     0.2702702702702703, 0.1647058823529412, 0.14893617021276598, 0.18018018018018017,
                     0.22448979591836735, 0.28205128205128205, 0.4210526315789474, 0.35714285714285715,
                     0.2105263157894737, 0.3047619047619048, 0.1702127659574468, 0.1322314049586777, 0.3529411764705882,
                     0.22222222222222224, 0.2916666666666667, 0.35443037974683544, 0.2831858407079646,
                     0.15929203539823006, 0.2156862745098039, 0.37254901960784315, 0.38095238095238104,
                     0.24719101123595508, 0.2982456140350877, 0.3272727272727273, 0.20000000000000004,
                     0.1834862385321101, 0.125, 0.20454545454545453, 0.3564356435643565, 0.13559322033898305,
                     0.2823529411764706, 0.17475728155339804, 0.2061855670103093, 0.3272727272727273,
                     0.2285714285714286, 0.24074074074074073, 0.2921348314606742, 0.21359223300970873,
                     0.30357142857142855, 0.20454545454545453, 0.33898305084745767, 0.19999999999999998,
                     0.12612612612612611, 0.5111111111111112, 0.21621621621621623, 0.22448979591836735,
                     0.27956989247311825, 0.2247191011235955, 0.2376237623762376, 0.24742268041237112, 0.125,
                     0.17391304347826086, 0.33707865168539325, 0.30107526881720437, 0.2988505747126437,
                     0.1818181818181818, 0.36170212765957455, 0.21238938053097342, 0.2, 0.22916666666666666,
                     0.24242424242424243, 0.1651376146788991, 0.21153846153846154, 0.3302752293577982,
                     0.1818181818181818, 0.49484536082474223, 0.17307692307692307, 0.17073170731707316,
                     0.1188118811881188, 0.41999999999999993, 0.3789473684210526, 0.368421052631579, 0.3106796116504854,
                     0.24, 0.18750000000000003, 0.22222222222222224, 0.17857142857142855, 0.3939393939393939,
                     0.1590909090909091, 0.35185185185185186, 0.3076923076923077, 0.1851851851851852,
                     0.1978021978021978, 0.29545454545454547, 0.1090909090909091, 0.2526315789473685,
                     0.45045045045045046, 0.1276595744680851, 0.2518518518518518, 0.19607843137254902,
                     0.20408163265306126, 0.21487603305785127, 0.2391304347826087, 0.06382978723404255,
                     0.0967741935483871, 0.4000000000000001, 0.2616822429906542, 0.13725490196078433,
                     0.21978021978021978, 0.16842105263157894, 0.11650485436893204, 0.2150537634408602,
                     0.2391304347826087, 0.17391304347826086, 0.2549019607843137, 0.4869565217391305, 0.205607476635514,
                     0.33613445378151263, 0.2, 0.27083333333333337, 0.30927835051546393, 0.3232323232323232,
                     0.3434343434343435, 0.2727272727272727, 0.17475728155339804, 0.29702970297029707,
                     0.32558139534883723, 0.2558139534883721, 0.2857142857142857, 0.1818181818181818,
                     0.3296703296703297, 0.07272727272727272, 0.24444444444444446, 0.36, 0.2564102564102564,
                     0.3232323232323232, 0.24528301886792453, 0.425, 0.5242718446601942, 0.17647058823529413,
                     0.15730337078651685, 0.22400000000000003, 0.43037974683544306, 0.37499999999999994,
                     0.11650485436893204, 0.36170212765957455, 0.2285714285714286, 0.05063291139240506,
                     0.29629629629629634, 0.19469026548672566, 0.2619047619047619, 0.18556701030927833,
                     0.12844036697247707, 0.25, 0.24691358024691357, 0.2626262626262626, 0.39999999999999997,
                     0.2058823529411765, 0.24742268041237112, 0.2666666666666666, 0.14285714285714285,
                     0.34693877551020413, 0.1590909090909091, 0.2417582417582418, 0.2909090909090909,
                     0.3689320388349514, 0.31775700934579443, 0.13592233009708737, 0.1964285714285714,
                     0.11764705882352941, 0.22580645161290325, 0.2268041237113402]
    f1_scores_025 = [0.28, 0.33663366336633666, 0.225, 0.15217391304347827, 0.12844036697247707, 0.12499999999999997,
                     0.24242424242424243, 0.21739130434782608, 0.34090909090909094, 0.1904761904761905,
                     0.30434782608695654, 0.2641509433962264, 0.3232323232323232, 0.2524271844660194,
                     0.17721518987341772, 0.26666666666666666, 0.09302325581395349, 0.24742268041237112,
                     0.1523809523809524, 0.32989690721649484, 0.3529411764705882, 0.4367816091954023,
                     0.36781609195402293, 0.3486238532110092, 0.1923076923076923, 0.39622641509433965,
                     0.2826086956521739, 0.12195121951219513, 0.20202020202020204, 0.1411764705882353,
                     0.1411764705882353, 0.2857142857142857, 0.1379310344827586, 0.1914893617021277,
                     0.22916666666666666, 0.32, 0.34615384615384615, 0.18604651162790697, 0.29787234042553196,
                     0.19354838709677422, 0.16091954022988506, 0.15384615384615385, 0.2526315789473685, 0.3,
                     0.4301075268817204, 0.23999999999999996, 0.21686746987951808, 0.32075471698113206,
                     0.10416666666666666, 0.15384615384615385, 0.2988505747126437, 0.22988505747126436,
                     0.35164835164835173, 0.2666666666666666, 0.1818181818181818, 0.21621621621621623,
                     0.30107526881720437, 0.35714285714285715, 0.5063291139240508, 0.27586206896551724,
                     0.30769230769230765, 0.3061224489795918, 0.13793103448275862, 0.16666666666666666,
                     0.09836065573770492, 0.22222222222222224, 0.29508196721311475, 0.15517241379310345,
                     0.29787234042553196, 0.13861386138613863, 0.21782178217821785, 0.3963963963963964, 0.24,
                     0.24242424242424243, 0.4137931034482759, 0.24761904761904763, 0.29906542056074764,
                     0.1647058823529412, 0.3360000000000001, 0.2061855670103093, 0.15625, 0.4819277108433735,
                     0.1818181818181818, 0.18749999999999997, 0.21276595744680854, 0.19277108433734938,
                     0.3434343434343435, 0.1904761904761905, 0.11475409836065574, 0.22400000000000003,
                     0.30434782608695654, 0.3488372093023256, 0.268041237113402, 0.2, 0.36170212765957455,
                     0.21052631578947367, 0.16279069767441862, 0.18604651162790697, 0.27368421052631575,
                     0.11009174311926606, 0.1834862385321101, 0.3505154639175258, 0.25806451612903225,
                     0.4313725490196078, 0.16981132075471697, 0.14102564102564102, 0.1379310344827586,
                     0.43809523809523804, 0.34782608695652173, 0.3963963963963964, 0.288659793814433,
                     0.2947368421052632, 0.1935483870967742, 0.26153846153846155, 0.23931623931623933, 0.296875,
                     0.11494252873563218, 0.32478632478632474, 0.30107526881720437, 0.18018018018018017,
                     0.2528735632183908, 0.27586206896551724, 0.16494845360824742, 0.2264150943396226, 0.38, 0.12,
                     0.2153846153846154, 0.22222222222222224, 0.24242424242424243, 0.24793388429752067,
                     0.23529411764705882, 0.15217391304347827, 0.11347517730496455, 0.4285714285714286,
                     0.2181818181818182, 0.1206896551724138, 0.2916666666666667, 0.1584158415841584,
                     0.22448979591836735, 0.13186813186813184, 0.24999999999999994, 0.2653061224489796,
                     0.26506024096385544, 0.4666666666666666, 0.28, 0.3731343283582089, 0.2626262626262626,
                     0.20930232558139533, 0.3076923076923077, 0.23529411764705882, 0.31250000000000006,
                     0.2641509433962264, 0.19834710743801653, 0.3191489361702128, 0.27659574468085113,
                     0.3157894736842105, 0.23529411764705882, 0.2117647058823529, 0.2264150943396226,
                     0.06185567010309278, 0.2692307692307692, 0.32, 0.25, 0.3655913978494624, 0.20224719101123595,
                     0.42857142857142855, 0.5567010309278351, 0.16842105263157894, 0.1553398058252427,
                     0.22580645161290325, 0.41666666666666663, 0.44, 0.08602150537634408, 0.41818181818181815,
                     0.24742268041237112, 0.04705882352941177, 0.3333333333333333, 0.1290322580645161,
                     0.23529411764705882, 0.13861386138613863, 0.099009900990099, 0.3232323232323232, 0.225,
                     0.24242424242424243, 0.37647058823529417, 0.2831858407079646, 0.3168316831683168,
                     0.35000000000000003, 0.14545454545454545, 0.3440860215053763, 0.15730337078651685,
                     0.27586206896551724, 0.2524271844660194, 0.44, 0.34, 0.1290322580645161, 0.15929203539823006,
                     0.1651376146788991, 0.24, 0.2857142857142857]

    f1_scores = [f1_scores_023, f1_scores_024, f1_scores_025]
    label_list = ['using 100 classes', 'using 50 classes', 'using 20 classes']
    draw_hist(f1_scores, list(range(200)),label_list, info='f1 scores of cifar-100 with resnet18')